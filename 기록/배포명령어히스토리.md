# 백엔드 빌드 , 도커 빌드
./gradlew clean build
docker build -t studyhub-backend:local .
docker run -p 8080:8080 studyhub-backend:local

> 도커 테스트 시에는 `localhost` 대신 `host.docker.internal`

# Artifact Registry
Docker가 Artifact Registry에 로그인 가능하게 만들기
`gcloud auth configure-docker asia-northeast3-docker.pkg.dev`
# 로컬 이미지에 Artifact Registry용 태그 붙이기
`docker tag studyhub-backend:local asia-northeast3-docker.pkg.dev/YOUR_PROJECT_ID/studyhub-backend-repo/studyhub-backend:latest`
# Artifact Registry로 이미지 push
`docker push asia-northeast3-docker.pkg.dev/YOUR_PROJECT_ID/studyhub-backend-repo/studyhub-backend:latest`
# Cloud Run 배포
`gcloud run deploy studyhub-backend --image=asia-northeast3-docker.pkg.dev/YOUR_PROJECT_ID/studyhub-backend-repo/studyhub-backend:latest --platform=managed --region=asia-northeast3 --allow-unauthenticated`


# Cloud SQL PostgreSQL 인스턴스 만들기
- GCP 콘솔 → Cloud SQL → 인스턴스 만들기
- PostgreSQL 선택
- 프로젝트: 지금 프로젝트
- 리전: asia-northeast3 (서울로 맞추면 좋음)
- DB 이름, 사용자, 비밀번호 기억해두기
# Cloud SQL Connector 추가
```gradle
implementation 'org.postgresql:postgresql'
implementation 'com.google.cloud.sql:postgres-socket-factory:1.13.1'
```
```properties
spring.datasource.url=jdbc:postgresql://google/DB이름?socketFactory=com.google.cloud.sql.postgres.SocketFactory&cloudSqlInstance=YOUR_PROJECT_ID:asia-northeast3:인스턴스이름&sslmode=disable
spring.datasource.username=DB_유저명
spring.datasource.password=DB_비밀번호
```
# Cloud Run 배포 시 Cloud SQL 인스턴스 연결 옵션 추가
```bash
gcloud run deploy studyhub-backend --image=asia-northeast3-docker.pkg.dev/YOUR_PROJECT_ID/studyhub-backend-repo/studyhub-backend:latest --platform=managed --region=asia-northeast3 --allow-unauthenticated --add-cloudsql-instances=YOUR_PROJECT_ID:asia-northeast3:인스턴스이름
```


# Firebase
Firebase Console 에서 프로젝트만들고 firbase cli npm downlaod
```bash
firebase login
firebase use --add  # 방금 만든 Firebase 프로젝트 선택
firebase init
```

# 프론트엔드 빌드 배포
```bash
npm run build:prod         # Vite 빌드해서 dist 생성
firebase deploy --only hosting
```
